<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">

  <script>

    function convertMarkdown2Textile() {
      var convert = function (orgString) {
        let buffer = orgString;
        buffer = buffer.replace(/^### /gm, 'h3. '); //  見出し変換 
        buffer = buffer.replace(/^## /gm, 'h2. ');
        buffer = buffer.replace(/^# /gm, 'h1. ');
        buffer = buffer.replace(/(h[1-3]\. .*)(\r\n|\r|\n)(?!(\r\n|\r|\n))/g, '$1$2$2$3');  //  見出しの次の行に空行追加
        return buffer;
      };

      document.getElementById('converterd').value = convert(document.getElementById('input').value);
    }

  </script>
</head>

<body>
  <p><label for="input">Markdownを入力:</label>
  <p><textarea cols="120" rows="10" id="input"></textarea></p>
  <p><input type="button" value="Textileに変換" onclick="convertMarkdown2Textile();"></p>
  <p><textarea cols="120" rows="10" id="converterd">textile</textarea></p>
</body>

</html>